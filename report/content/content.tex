\newcommand{\content}{
    % добавляем нумерацию
    \AddToShipoutPicture{
        \begin{textblock*}{1cm}(19.5cm,28.6cm) % Ширина блока, координаты (x, y)
                \centering 
                \number\numexpr\thepage+1\relax
        \end{textblock*}
    }

    % добавляем шифр
    \AddToShipoutPicture{
        \begin{textblock*}{10cm}(9cm,28.2cm) % Ширина блока, координаты (x, y)
            \centering
            \chipher
        \end{textblock*}
    }

    % шифр на 1ый лист
    \begin{textblock*}{10cm}(9cm,28.2cm) % Ширина блока, координаты (x, y)
        \centering
        \chipher
    \end{textblock*}
\renewcommand{\baselinestretch}{1.2}

\section*{ВВЕДЕНИЕ}
\vspace{13pt}
\addcontentsline{toc}{section}{ВВЕДЕНИЕ}


Глаукома является одним из ведущих заболеваний, вызывающих необратимую слепоту \cite{glaucoma}. 
Своевременное выявление и диагностика глаукомы играют ключевую роль в сохранении зрения пациента. 
Современные методы диагностики включают использование специализированных изображений глазного дна и различных сканирующих устройств, таких как оптическая когерентная томография (OCT). 

В последние годы методы машинного обучения и глубокого обучения показывают высокую эффективность в автоматизации процессов диагностики. 
Данная работа посвящена разработке и обучению нейронной сети для автоматического распознавания глаукомы по изображениям глазного дна. 
Целью исследования является достижение высокой точности распознавания заболевания, что может значительно сократить время диагностики и снизить нагрузку на врачей.

В рамках работы была использована нейронная сеть, основанная на архитектуре MobileNetV3, а также подготовлен датасет для обучения, валидации и тестирования модели. 
Проект реализован на языке программирования Python с использованием библиотеки PyTorch.

\newpage
\section{СИСТЕМНЫЙ АНАЛИЗ ПРЕДМЕТНОЙ ОБЛАСТИ}

        {Характеристика проблемы классификации глаукомы}
    
        Глаукома представляет собой хроническое прогрессирующее заболевание глаз, характеризующееся повреждением зрительного нерва, которое может привести к полной потере зрения. Основными факторами риска развития глаукомы являются повышенное внутриглазное давление, возраст, генетическая предрасположенность и сопутствующие заболевания, такие как сахарный диабет \cite{glaucoma_review}.
        
        Классификация глаукомы по изображениям глазного дна представляет собой сложную задачу, обусловленную несколькими причинами:
        \begin{itemize}
            \item высокая вариативность изображений, связанная с особенностями индивидуальной анатомии глаза, различными стадиями заболевания и условиями получения снимков;
            \item перекрытие визуальных признаков глаукомы с другими заболеваниями глаз, такими как диабетическая ретинопатия или возрастная макулярная дегенерация;
            \item ограниченность объемов доступных размеченных данных для обучения алгоритмов, что затрудняет построение надежных моделей.
        \end{itemize}
        
        Ручной анализ изображений глазного дна требует значительных временных и трудовых ресурсов со стороны врачей-офтальмологов, что актуализирует необходимость разработки автоматизированных систем классификации. Использование методов глубокого обучения позволяет обрабатывать большие объемы данных и демонстрировать высокую точность в диагностике глаукомы.
        
        Задача данной работы заключается в создании нейронной сети, способной эффективно классифицировать изображения глазного дна с целью раннего выявления глаукомы, что имеет важное значение для своевременного начала лечения и предотвращения необратимых последствий.
        \vspace{13pt}
    \subsection{Обзор существующих методов и систем классификации}

    В настоящее время существует множество подходов к диагностике глаукомы, основанных на анализе изображений глазного дна. Эти подходы можно разделить на три основные категории: традиционные методы обработки изображений, машинное обучение и глубокое обучение.

    \subsubsection*{Традиционные методы обработки изображений}

    Традиционные методы обработки изображений используют различные алгоритмы для извлечения и анализа визуальных признаков глазного дна, таких как размер диска зрительного нерва, соотношение «чашка-диск» (cup-to-disc ratio, CDR) и плотность нервных волокон. Эти подходы требуют значительных усилий для ручной настройки параметров обработки изображений, что ограничивает их универсальность.

    \subsubsection*{Методы машинного обучения}

    Методы машинного обучения, такие как поддерживающие векторные машины (SVM), случайные леса и методы k-ближайших соседей (k-NN), позволяют автоматизировать процесс классификации. Однако для их использования требуется предварительное извлечение признаков из изображений, что делает процесс более трудоемким. Эффективность этих методов сильно зависит от качества выделенных признаков и объема размеченных данных \cite{machine_learnig}.

    \subsubsection*{Методы глубокого обучения}

    Глубокое обучение, в частности использование сверточных нейронных сетей (CNN), стало революционным подходом к классификации изображений. Сверточные сети способны автоматически извлекать признаки из изображений, устраняя необходимость ручного вмешательства. Среди популярных архитектур, применяемых для диагностики глаукомы, можно выделить следующие:
    \begin{itemize}
        \item \textbf{ResNet (Residual Networks):} сети с остаточными связями, которые позволяют эффективно обучать глубокие модели;
        \item \textbf{Inception-v3:} архитектура, оптимизированная для извлечения многоуровневых признаков;
        \item \textbf{MobileNet:} легковесные сети, предназначенные для работы на устройствах с ограниченными вычислительными ресурсами.
    \end{itemize}

    Некоторые из существующих систем классификации глаукомы основаны на публичных наборах данных, таких как REFUGE, Drishti-GS, и ORIGA, которые предоставляют изображения глазного дна с аннотациями. Тем не менее, большинство систем требуют больших вычислительных мощностей для достижения высокой точности, что может ограничивать их использование в клинической практике.

    \subsubsection*{Заключение}

    Обзор существующих методов показывает, что глубокие нейронные сети являются наиболее перспективным инструментом для классификации глаукомы. В данной работе используется архитектура MobileNetV3, которая сочетает высокую точность и эффективность, что делает ее подходящей для медицинских приложений.
    \vspace{13pt}
    \subsection{Выбор подходов и инструментов для реализации задачи}

    Для реализации задачи классификации глаукомы по изображениям глазного дна был выбран подход на основе глубокого обучения, в частности использование сверточных нейронных сетей (CNN). Этот выбор обусловлен высокими результатами, которые демонстрируют нейронные сети при решении задач компьютерного зрения, в том числе диагностики заболеваний глаз, таких как глаукома \cite{CNN}.

    \subsubsection*{Выбор архитектуры нейронной сети}

    Одной из наиболее эффективных архитектур для обработки изображений является MobileNetV3. Данная модель была выбрана по нескольким причинам:
    \begin{itemize}
        \item \textbf{легковесность и эффективность:} MobileNetV3 оптимизирована для работы на устройствах с ограниченными вычислительными ресурсами, что делает ее подходящей для клинических приложений, где скорость обработки изображений и ресурсоэффективность являются важными факторами;
        \item \textbf{высокая точность:} Архитектура MobileNetV3 достигает высокой точности при сравнительно небольшой сложности, что позволяет эффективно решать задачи классификации изображений глазного дна;
        \item \textbf{предобученные веса:} Модель MobileNetV3 доступна с предобученными весами, что позволяет ускорить процесс обучения и повысить точность классификации при меньшем объеме данных для дообучения.
    \end{itemize}

    \subsubsection*{Используемые инструменты и библиотеки}

    Для реализации и обучения модели использовались следующие инструменты и библиотеки:
    \begin{itemize}
        \item \textbf{PyTorch:} Открытая библиотека для машинного обучения, которая предоставляет мощные средства для работы с нейронными сетями. PyTorch был выбран благодаря своей гибкости, простоте в использовании и широкому сообществу разработчиков, что позволяет быстро решать задачи обучения моделей \cite{pytorch_docs};
        \item \textbf{TorchVision:} Библиотека, предоставляющая инструменты для работы с изображениями, включая предварительно обученные модели, трансформации изображений и загрузку данных;
        \item \textbf{NumPy и Pandas:} Библиотеки для работы с массивами данных и анализа статистики, которые использовались для обработки данных и подсчета метрик;
        \item \textbf{Matplotlib и Seaborn:} Библиотеки для визуализации данных и графиков, которые применялись для анализа результатов обучения и тестирования модели;
        \item \textbf{CUDA и cuDNN:} Использование GPU с поддержкой CUDA и cuDNN позволило значительно ускорить процесс обучения модели, что особенно важно при работе с большими объемами данных.
    \end{itemize}

    \subsubsection*{Выбор данных для обучения}

    Для обучения модели был выбран датасет Eyepac, который содержит изображения глазного дна, размеченные для задач классификации глаукомы. Этот датасет был выбран по следующим причинам:
    \begin{itemize}
        \item \textbf{качество и разнообразие данных:} Датасет содержит изображения с различными стадиями глаукомы и здоровыми глазами, что позволяет обучить модель на репрезентативном наборе данных;
        \item \textbf{публичность:} Датасет доступен для использования и имеет открытые лицензии, что позволяет использовать его в исследовательских и коммерческих целях;
        \item \textbf{размер выборки:} Датасет содержит достаточное количество размеченных изображений для обучения и тестирования модели, что позволяет добиться высокой точности классификации.
    \end{itemize}

    \subsubsection*{Методы предобработки данных}

    Для улучшения качества модели были применены различные методы предобработки данных, включая:
    \begin{itemize}
        \item \textbf{масштабирование изображений:} Все изображения были приведены к единому размеру для упрощения обработки;
        \item \textbf{аугментация данных:} Для увеличения разнообразия обучающей выборки были использованы методы аугментации, такие как случайные перевороты, изменения яркости и контраста, добавление шума и другие трансформации;
        \item \textbf{нормализация:} Все изображения были нормализованы с использованием стандартных значений для предобученной модели MobileNetV3.
    \end{itemize}

    \subsubsection*{Вывод}

    Для решения задачи классификации глаукомы было выбрано использование нейронной сети MobileNetV3, которая предоставляет хороший баланс между точностью и вычислительной эффективностью. Все инструменты и методы были выбраны с учетом требований задачи, что позволяет добиться высокой производительности и точности классификации при работе с изображениями глазного дна.

\newpage


\section{ПОДГОТОВКА И АНАЛИЗ ДАТАСЕТА}

    \subsection{Описание и структура eyepac-light-v2-512-jpg Dataset}

    Датасет eyepac-light-v2-512-jpg был использован для обучения и тестирования модели классификации глаукомы. Данный датасет состоит из изображений глазного дна, размеченных по категориям, что позволяет проводить бинарную классификацию на две группы: глаукома и отсутствие глаукомы. Датасет был получен с платформы Kaggle и является расширенной версией датасета Eyepac, предназначенной для задач классификации глаукомы \cite{dataset}.

    \subsubsection*{Структура датасета}

    Датасет eyepac-light-v2-512-jpg состоит из трёх основных папок:
    \begin{itemize}
        \item train: Папка, содержащая обучающие данные;
        \item validation: Папка для валидации модели, содержащая изображения для проверки качества работы модели на промежуточных этапах обучения;
        \item test: Папка с тестовыми данными, которая используется для окончательной оценки точности модели после её обучения.
    \end{itemize}

    В каждой из этих папок (train, validation, test) содержатся две подпапки:
    \begin{itemize}
        \item NRG: Папка, содержащая изображения глазного дна пациентов с несущественной глаукомой (Non-Referable Glaucoma, NRG). Эти изображения классифицируются как отсутствие глаукомы;
        \item RG: Папка, содержащая изображения глазного дна пациентов с диагнозом реферируемая глаукома (Referable Glaucoma, RG). Эти изображения классифицируются как наличие глаукомы.
    \end{itemize}

    Каждое изображение в этих папках представляет собой JPEG-файл с разрешением 512x512 пикселей. 
    \subsubsection*{Классификация изображений}

    Изображения в папке RG относятся к классу "глаукома" (Referable  Glaucoma, RG), то есть они содержат признаки, которые могут быть использованы для диагностики глаукомы. Изображения из папки NRG относятся к классу "без глаукомы" (Non-Referable Glaucoma, NRG), что означает отсутствие явных признаков заболевания.

    Эта структура позволяет эффективно обучать модели глубокого обучения для бинарной классификации, где задача модели — различить два класса: наличие глаукомы (RG) и её отсутствие (NRG).

    \subsubsection*{Количество изображений в датасете}

    Количество изображений в каждой из папок зависит от разделения датасета на обучающую, валидационную и тестовую выборки. Это разделение помогает предотвратить переобучение модели и дает возможность оценить её эффективность на независимом наборе данных. Точные цифры количества изображений в каждой категории могут варьироваться, и для получения информации о конкретном размере датасета необходимо провести анализ на этапе подготовки данных. 

    Датасет имеет сбалансированное распределение классов, что важно для предотвращения смещения в обучении модели, что позволяет достичь хорошей точности классификации.

    \subsubsection*{Предобработка данных}

    Для подготовки изображений к обучению были выполнены следующие шаги:
    \begin{itemize}
        \item изображения были масштабированы до размера 512x512 пикселей для унификации входных данных;
        \item применены методы аугментации, такие как случайные перевороты, изменения яркости и контраста, что позволяет повысить разнообразие обучающего набора;
        \item для нормализации изображений использовались стандартные значения, полученные из предобученной модели MobileNetV3.
    \end{itemize}

    Предобработка данных и их организация в структуру папок train,  validation и test позволяет эффективно обучать и тестировать модель классификации, минимизируя возможные ошибки при загрузке данных и их обработке.
    \vspace{13pt}
    \subsection{Предварительная обработка данных и балансировка классов}

    Для успешного обучения модели классификации глаукомы важно провести предварительную обработку данных и обеспечить балансировку классов. Эти этапы позволяют улучшить качество обучения модели и повысить её точность, предотвращая переобучение и проблемы с недообучением.
    
    \subsubsection*{Предварительная обработка данных}
    
    Предварительная обработка данных является неотъемлемой частью работы с изображениями, поскольку она помогает улучшить качество данных, адаптируя их для дальнейшего использования в модели глубокого обучения. В рамках подготовки датасета eyepac-light-v2-512-jpg были выполнены следующие этапы обработки:
    
    \begin{itemize}
        \item \textbf{изменение размера изображений:} Все изображения были приведены к единому размеру 512x512 пикселей. Это необходимо, чтобы модель могла обрабатывать изображения одинакового размера, что упрощает обучение и снижает вычислительные затраты.
        
        \item \textbf{нормализация изображений:} Для улучшения обучения и ускорения сходимости сети все изображения были нормализованы. Были использованы стандартные значения для предобученной модели MobileNetV3: 
        \begin{itemize}
            \item Среднее значение (\(\mu\)): [0.485, 0.456, 0.406]
            \item Стандартное отклонение (\(\sigma\)): [0.229, 0.224, 0.225]
        \end{itemize}
        
        \item \textbf{аугментация данных:} Для увеличения разнообразия обучающего набора и улучшения обобщающих способностей модели были применены различные методы аугментации изображений. Эти методы включают:
        \begin{itemize}
            \item случайное горизонтальное и вертикальное отражение;
            \item изменение яркости, контраста, насыщенности и оттенка (ColorJitter), что помогает модели быть более устойчивой к изменениям освещенности и качества изображений;
            \item добавление случайного шума для повышения устойчивости модели к возможным искажениям в реальных условиях.
        \end{itemize}
        
        Эти методы аугментации позволяют существенно увеличить размер обучающего набора без необходимости вручную собирать дополнительные данные, что помогает уменьшить риск переобучения;
    
        \item \textbf{приведение всех изображений к одинаковому формату:} Все изображения были сохранены в формате JPEG с разрешением 512x512 пикселей для обеспечения согласованности данных.
    \end{itemize}
    
    \subsubsection*{Балансировка классов}
    
    Одной из ключевых проблем в задачах классификации является дисбаланс классов, когда один из классов значительно преобладает в наборе данных. Это может привести к плохой производительности модели, так как она будет склонна предсказывать более частый класс, игнорируя редкий. В случае с классификацией глаукомы классы могут быть неравномерными, что может повлиять на точность модели.
    
    Для решения этой проблемы были использованы следующие методы балансировки классов:
    
    \begin{itemize}
        \item \textbf{использование аугментации для меньшинственного класса:} Дополнительные изображения были сгенерированы для класса с меньшим количеством примеров (например, для класса RG — глаукома), что помогло улучшить баланс классов и избежать преобладания одного из них;
        
        \item \textbf{сбалансированное разделение данных:} Для каждого из наборов данных (train, validation, test) было обеспечено сбалансированное распределение изображений между классами. Это позволяет модели видеть примерно равное количество примеров для каждого класса и предотвращает смещение в сторону более частого класса;
        
        \item \textbf{взвешенные потери (Weighted Loss):} В случае если классы в наборе данных сильно несбалансированы, может быть полезным применить взвешивание потерь для модели. Это позволяет более серьезно учитывать ошибки на менее представленных классах. В этой работе был использован стандартный механизм CrossEntropyLoss с возможностью настройки весов для каждого класса.
    \end{itemize}
    
    \subsubsection*{Вывод}
    
    Предварительная обработка данных и балансировка классов являются важными этапами подготовки датасета для эффективного обучения модели. Применение аугментации данных и нормализации изображений значительно улучшает обобщающие способности модели, а методы балансировки классов предотвращают проблемы с переобучением и смещением модели в сторону более представленных классов. Эти меры способствуют более точной и надежной классификации глаукомы на изображениях глазного дна.
    

    % ---------------------------------------- %
    \vspace{13pt}
    \subsection{Анализ распределения классов и характеристик изображений}

    Анализ распределения классов и характеристик изображений является важным этапом при подготовке данных для обучения модели. Это позволяет не только оценить сбалансированность классов, но и понять возможные проблемы в данных, которые могут повлиять на качество обучения и точность модели.

    \subsubsection*{Распределение классов}

    Одной из важнейших задач при работе с датасетами является анализ распределения классов. В нашем случае классы делятся на две категории:
    \begin{itemize}
        \item \textbf{NRG (Non-Referable Glaucoma)}: Класс, содержащий изображения глазного дна, на которых не наблюдаются явные признаки глаукомы или которые не могут быть использованы для диагностики глаукомы;
        \item \textbf{RG (Referable Glaucoma)}: Класс, содержащий изображения глазного дна с признаками, которые могут указывать на глаукому и требуют внимания специалистов.
    \end{itemize}

    \subsubsection*{Анализ характеристик изображений}

    Каждое изображение в датасете представляет собой изображение глазного дна, на котором могут быть видны признаки глаукомы, такие как изменения в сосудистом рисунке, оптическом диске и других структурах сетчатки. Все изображения были приведены к одному размеру (512x512 пикселей), что облегчает процесс обучения модели. Тем не менее важно учитывать следующие характеристики изображений:

    \begin{itemize}
        \item \textbf{качество изображений:} Все изображения имеют достаточное качество для выявления признаков глаукомы, но могут содержать искажения, такие как шум или дефекты, возникшие при сканировании. Эти факторы могут влиять на производительность модели, особенно если они не были учтены при аугментации;
        
        \item \textbf{динамика контраста:} Изображения глазного дна могут сильно различаться по контрасту и освещенности. Для устранения этой проблемы была применена техника ColorJitter, которая случайным образом изменяет контраст, яркость, насыщенность и оттенок изображений. Это помогает модели стать более устойчивой к изменениям освещенности в реальных условиях;

        \item \textbf{шум на изображениях:} Некоторые изображения могут содержать шум, который затрудняет выявление важных особенностей. Для борьбы с этим был использован метод добавления случайного шума в процессе аугментации данных. Это позволяет улучшить способность модели к обобщению и повысить её устойчивость к возможным искажениям при реальном сканировании глазного дна;
        
        \item \textbf{асимметричные распределения признаков:} Признаки глаукомы, такие как изменения в размере диска зрительного нерва или сосудистой сетки, могут быть асимметричными. Это требует от модели способности выделять признаки, расположенные в разных частях изображения, а не только в центральной области.
    \end{itemize}

    Анализ этих характеристик позволяет выявить потенциальные трудности, с которыми модель может столкнуться в процессе обучения, и заранее принять меры для улучшения её производительности.

    \subsubsection*{Вывод}

    Анализ распределения классов и характеристик изображений показал, что данные в датасете eyepac-light-v2-512-jpg относительно сбалансированы, что способствует успешному обучению модели. Однако важно учитывать возможные искажения в изображениях, такие как шум и изменения освещенности, которые могут повлиять на точность модели. Для повышения устойчивости модели к таким проблемам были применены методы аугментации и нормализации данных. Эти меры помогут улучшить качество классификации и повысить её точность при распознавании глаукомы.

    % ---------------------------------------- %
\newpage
\section{ПРОЕКТИРОВАНИЕ И ОБУЧЕНИЕ НЕЙРОННОЙ СЕТИ}

    \subsection{Выбор архитектуры модели}

    Выбор архитектуры нейронной сети является одним из ключевых этапов в решении задачи классификации глаукомы. Архитектура сети должна быть не только эффективной, но и способной обрабатывать изображения с высокой разрешающей способностью, обеспечивая высокую точность классификации. В данной работе для решения задачи классификации глаукомы была выбрана архитектура на основе мобильной сети MobileNetV3, которая является оптимизированной для работы с изображениями, имеет хорошее соотношение между точностью и производительностью, а также подходит для использования в реальных приложениях.

    \subsubsection*{Почему MobileNetV3?}

    MobileNetV3 представляет собой улучшенную версию предыдущих архитектур MobileNet, разработанных для работы на устройствах с ограниченными вычислительными ресурсами, таких как мобильные телефоны и встраиваемые системы. В отличие от более тяжелых моделей, таких как ResNet или VGG, MobileNetV3 использует оптимизации, такие как глубинные сверточные слои (depthwise separable convolutions) и различные методы свертки, что делает её легкой и быстрой, сохраняя при этом высокую точность. Это особенно важно для задач, требующих обработки изображений с высоким разрешением, таких как классификация глаукомы, где быстрое выполнение модели может быть критичным \cite{mobilenet}.

    Основные преимущества MobileNetV3:

    \begin{itemize}
        \item \textbf{малый размер модели:} Благодаря использованию глубинных сверток и оптимизации вычислений, модель имеет небольшой размер, что снижает требования к памяти и ускоряет выполнение;
        \item \textbf{высокая производительность:} MobileNetV3 демонстрирует высокую точность на задачах классификации изображений при значительно меньших вычислительных затратах по сравнению с другими, более тяжелыми архитектурами;
        \item \textbf{оптимизация для мобильных устройств:} Архитектура была разработана с учетом ограничений на устройствах с низкой мощностью, что делает её подходящей для внедрения в реальные медицинские системы, которые могут работать на ограниченных вычислительных ресурсах.
    \end{itemize}

    \subsubsection*{Структура MobileNetV3}

    Архитектура MobileNetV3 состоит из нескольких слоев:

    \begin{itemize}
        \item \textbf{начальная свертка:} Модель начинается с обычной свертки для извлечения базовых признаков из изображений;
        \item \textbf{глубинные свертки (Depthwise Separable Convolutions):} Используются для уменьшения вычислительных затрат, при этом сохраняется высокая способность к извлечению признаков;
        \item \textbf{блоки с адаптивной активацией и слоями внимания:} В архитектуре MobileNetV3 используются улучшенные механизмы внимания, которые позволяют модели фокусироваться на наиболее значимых частях изображения для улучшения точности;
        \item \textbf{полносвязный слой и классификация:} В конце сети находится полносвязный слой, который выполняет классификацию на основе извлеченных признаков, с использованием softmax для определения вероятности принадлежности изображения к одному из классов (RG или NRG).
    \end{itemize}

    \subsubsection*{Настройка модели}

    Для данной задачи классификации глаукомы была использована версия модели MobileNetV3 Large, которая подходит для решения задач с высоким уровнем сложности, таких как обработка изображений глазного дна. Эта версия модели демонстрирует отличную производительность на изображениях высокого разрешения, что важно для точного распознавания глаукомы. Для дополнительной оптимизации была использована предобученная модель MobileNetV3 на большом датасете ImageNet, что позволяет улучшить начальную инициализацию весов и ускорить обучение.

    Архитектура была модифицирована следующим образом:
    \begin{itemize}
        \item \textbf{замена последнего слоя классификации:} В оригинальной модели последний слой классификации был адаптирован под задачу бинарной классификации (глаукома/не глаукома) путём замены выходного слоя на слой с 2 нейронами, который соответствует числу классов;
        \item \textbf{функция активации:} Для финальной классификации был использован softmax, что позволяет модели предсказать вероятность принадлежности изображения к каждому из классов.
    \end{itemize}

    \subsubsection*{Вывод}

    В результате выбора архитектуры MobileNetV3 была создана эффективная модель для классификации глаукомы, способная работать с изображениями высокого разрешения при низких вычислительных затратах. Эта архитектура является оптимальным выбором для задач, где требуется высокая точность при ограниченных вычислительных ресурсах. Настройка модели, использование предобученной версии и адаптация последнего слоя под задачу бинарной классификации обеспечили успешную настройку и обучение модели, что позволило достичь высокой точности на тестовых данных.

    % ---------------------------------------- %
\vspace{13pt}
    \subsection{Подготовка данных для обучения и тестирования}

    Правильная подготовка данных является важнейшим этапом в процессе обучения нейронной сети, так как качество данных напрямую влияет на результативность модели. В данном разделе описывается процесс подготовки данных для обучения, валидации и тестирования модели на основе изображений глазного дна.

    \subsubsection*{Структура данных}

    Для обучения и тестирования модели использовался датасет eyepac-light-v2-512-jpg, состоящий из изображений глазного дна, которые классифицированы в два класса:
    \begin{itemize}
        \item \textbf{RG (Referable Glaucoma)}: Класс изображений с признаками глаукомы, которые требуют внимания специалиста;
        \item \textbf{NRG (Non-Referable Glaucoma)}: Класс изображений без явных признаков глаукомы.
    \end{itemize}

    Датасет разделен на три основные папки: train, validation и test, каждая из которых содержит подкатегории NRG и RG. Структура папок выглядит следующим образом:
    \begin{itemize}
        \item train/NRG, train/RG — для обучающего набора;
        \item validation/NRG, validation/RG — для валидационного набора;
        \item test/NRG, test/RG — для тестового набора.
    \end{itemize}

    Данные были организованы таким образом, чтобы обеспечивать возможность случайного разбиения на обучающую, валидационную и тестовую выборки, что способствует лучшему обобщению модели.

    \subsubsection*{Аугментация данных}

    Для улучшения обобщающей способности модели и предотвращения переобучения были применены различные методы аугментации данных. Аугментация данных помогает увеличить разнообразие обучающих примеров, что способствует лучшему обучению модели и повышению её устойчивости к различным вариантам изображений. В процессе аугментации были использованы следующие методы:
    \begin{itemize}
        \item \textbf{RandomHorizontalFlip}: Случайное горизонтальное зеркалирование изображений для увеличения разнообразия обучающих данных;
        \item \textbf{RandomVerticalFlip}: Случайное вертикальное зеркалирование изображений;
        \item \textbf{ColorJitter}: Случайные изменения яркости, контраста, насыщенности и оттенка изображения для имитации различных условий освещения;
        \item \textbf{AddNoise}: Добавление случайного шума к изображениям для повышения устойчивости модели к помехам и искажениям на изображениях;
        \item \textbf{Resize}: Изменение размера изображений до 512x512 пикселей для унификации входных данных.
    \end{itemize}

    Аугментация данных проводилась только на обучающем наборе данных, чтобы избежать утраты статистических свойств валидационных и тестовых данных, которые использовались для оценки модели.

    \subsubsection*{Нормализация данных}

    После аугментации и преобразования изображений в тензоры был выполнен процесс нормализации. Нормализация данных необходима для ускорения сходимости нейронной сети и повышения её стабильности. Для этого изображения были нормализованы по среднему значению и стандартному отклонению, полученному на основе предобученной модели MobileNetV3 на датасете ImageNet. Это позволило использовать весовые коэффициенты, предобученные на ImageNet, что ускорило обучение и улучшило производительность модели.
    
    Эта нормализация помогает улучшить точность и стабильность обучения, особенно при использовании предобученных моделей.

    \subsubsection*{Загрузчики данных}

    Для загрузки данных в процессе обучения были использованы объекты DataLoader из библиотеки PyTorch. Они обеспечивают эффективную загрузку данных с возможностью пакетной обработки, перемешивания и распределения данных по нескольким процессам для ускорения работы модели. Для каждого набора данных (обучающий, валидационный и тестовый) был создан свой DataLoader:
    \begin{itemize}
        \item train\_data — для обучающего набора с размером пакета (batch\_size) 4;
        \item validation\_data — для валидационного набора с размером пакета  (batch\_size) 4;
        \item test\_data — для тестового набора с размером пакета (batch\_size) 4.
    \end{itemize}

    Процесс загрузки данных был оптимизирован для ускорения обучения и предотвращения блокировки при чтении данных.

    \subsubsection*{Вывод}

    Подготовка данных для обучения модели включала в себя организацию данных в соответствии с разделением на обучающий, валидационный и тестовый наборы, а также применение различных методов аугментации для увеличения разнообразия данных и повышения устойчивости модели. Нормализация изображений и использование предобученной модели для инициализации весов позволили ускорить обучение и повысить точность модели. Благодаря использованию DataLoader и эффективной загрузке данных, процесс обучения был значительно оптимизирован.

    % ---------------------------------------- %
    \vspace{13pt}
    \subsection{Настройка гиперпараметров и обучение модели}

    Настройка гиперпараметров является ключевым этапом в процессе обучения нейронной сети. Правильная настройка гиперпараметров позволяет добиться хороших результатов при решении задачи классификации глаукомы. В данном разделе описывается выбор гиперпараметров, используемых в процессе обучения модели, а также сам процесс обучения.

    \subsubsection*{Выбор гиперпараметров}

    Для успешного обучения нейронной сети необходимо правильно выбрать следующие гиперпараметры:

    \begin{itemize}
        \item \textbf{количество эпох (epochs)}: Обучение модели будет происходить в нес-  колько эпох. Количество эпох было выбрано равным 6, так как это достаточно для того, чтобы модель успела научиться распознавать особенности изображений глазного дна, но не слишком большое, чтобы избежать переобучения;
        \item \textbf{размер пакета (batch size)}: Размер пакета был установлен на уровне 4. Этот выбор обусловлен необходимостью оптимизации скорости обучения и использованием ограниченной памяти GPU. Меньший размер пакета позволяет лучше контролировать обновление весов, но в то же время увеличивает время обучения;
        \item \textbf{скорость обучения (learning rate)}: Для начальной скорости обучения был выбран параметр 0.001. Это значение является стандартным и часто используется при обучении моделей с использованием алгоритма оптимизации Adam. Однако скорость обучения будет адаптироваться в процессе обучения с использованием планировщика (scheduler);
        \item \textbf{алгоритм оптимизации}: Для оптимизации модели был выбран алгоритм Adam, который является одним из самых популярных и эффективных для задач компьютерного зрения. Он адаптивно изменяет скорость обучения для каждого параметра, что делает его особенно полезным для нейронных сетей с большим числом параметров;
        \item \textbf{планировщик скорости обучения (learning rate scheduler)}: Был использован планировщик StepLR, который уменьшает скорость обучения на 10\% (группа gamma=0.1) каждые 3 эпохи. Это позволяет модели быстрее сходиться на начальных этапах обучения и затем стабилизировать обучение с меньшей скоростью.
    \end{itemize}

    \subsubsection*{Процесс обучения}

    Процесс обучения модели заключался в многократном проходе через обучающий набор данных, в ходе которого модель обновляла свои веса, минимизируя функцию потерь. Для классификации использовалась функция потерь CrossEntropyLoss, которая является стандартной для задач многоклассовой классификации, где метки классов представлены как целые числа.

    \begin{itemize}
        \item \textbf{функция потерь}: CrossEntropyLoss вычисляет разницу между предсказанными вероятностями и реальными метками, что позволяет модели корректировать свои веса;
        \item \textbf{оптимизатор}: Adam был выбран как оптимизатор, который адаптирует скорость обучения для каждого параметра на основе их градиентов. Это позволяет модели эффективно обновлять веса при минимальных вычислительных затратах;
        \item \textbf{планировщик обучения}: StepLR был использован для уменьшения скорости обучения каждые 3 эпохи, что позволяет улучшить сходимость модели и предотвратить переобучение.
    \end{itemize}

    Обучение модели включало два этапа:

    \begin{enumerate}
        \item \textbf{Обучение (Train phase)}: На этом этапе модель обновляла свои веса, минимизируя функцию потерь на основе обучающих данных. Для каждой эпохи вычислялся средний убыток и точность, после чего модель адаптировала свои веса для лучшего соответствия данным.
        \item \textbf{Валидация (Validation phase)}: После каждого этапа обучения выполнялась валидация модели на валидационном наборе данных. Это позволяло отслеживать точность модели на новых данных, которые не использовались для обучения, и предотвращать переобучение.
    \end{enumerate}

    \subsubsection*{Результаты обучения}

    В ходе обучения модель достигала максимальной точности на валидационном наборе данных, которая стабилизировалась на уровне 92\%. Это свидетельствует о хорошем качестве обучения, так как модель успешно научилась различать изображения с признаками глаукомы и без них.

    На тестовых данных модель также продемонстрировала точность, равную 92\%, что подтверждает её способность обобщать знания на новые данные и выполнять задачу классификации с высокой точностью.

    \subsubsection*{Вывод}

    Процесс обучения был успешно завершен с использованием модели MobileNetV3. Настройка гиперпараметров, таких как количество эпох, размер пакета, скорость обучения и выбор оптимизатора, позволила достичь высоких результатов. Использование оптимизатора Adam в сочетании с планировщиком скорости обучения StepLR обеспечило эффективное обновление весов модели и стабилизацию процесса обучения. В результате модель достигла точности 92\% на тестовых данных, что подтверждает её эффективность для задачи классификации глаукомы.

    % ---------------------------------------- %
    \vspace{13pt}
    \subsection{Использование методов регуляризации для повышения качества}

    Регуляризация является важной частью процесса обучения нейронной сети, так как она помогает предотвратить переобучение и улучшить обобщающие способности модели. В данном разделе рассматриваются методы регуляризации, которые были использованы для улучшения качества модели при решении задачи классификации глаукомы.

    \subsubsection*{Метод Dropout}

    Один из самых распространенных методов регуляризации — это Dropout. Этот метод заключается в случайном исключении некоторых нейронов на каждом шаге обучения, что препятствует излишней зависимостью модели от определенных признаков и помогает повысить её обобщающую способность.

    В данном проекте было принято решение не добавлять явный слой Dropout в модель MobileNetV3, так как эта модель уже включает в себя встроенные методы регуляризации, такие как использование сверточных слоев с малым числом параметров и нормализацию батча. Однако, для других моделей, таких как полносвязные нейронные сети, использование Dropout может значительно повысить точность и предотвратить переобучение.

    \subsubsection*{Раннее завершение (Early Stopping)}

    Раннее завершение — это метод регуляризации, который заключается в остановке обучения, как только модель перестает улучшаться на валидационном наборе данных. Это позволяет избежать переобучения, так как обучение продолжается только до того момента, когда модель начинает переобучаться на обучающих данных.

    Хотя данный метод не был реализован в модели напрямую, в ходе экспериментов использовалась валидация на каждом шаге обучения. Это позволяло отслеживать точность модели на валидационном наборе данных и при необходимости корректировать процесс обучения. Возможность остановки обучения при достижении определенного порога точности могла бы быть полезной для улучшения качества модели.

    \subsubsection*{Нормализация входных данных}

    Другим методом регуляризации является нормализация входных данных. Этот метод используется для того, чтобы данные, подаваемые на вход нейронной сети, имели схожие масштабы и распределение. В данном случае изображения были нормализованы по среднему значению и стандартному отклонению, полученному на основе предобученной модели MobileNetV3 на датасете ImageNet. Это способствовало более стабильному обучению и предотвратило проблемы, связанные с разными масштабами признаков.

    Нормализация значений пикселей изображений обеспечила единообразие данных и позволила модели эффективно работать с изображениями разных разрешений и характеристик.

    \subsubsection*{Аугментация данных}

    Аугментация данных является еще одним важным методом регуляризации, который был активно использован в ходе обучения модели. Этот метод заключается в создании новых примеров для обучения путем применения различных преобразований к исходным данным (например, изменение яркости, контраста, зеркалирование и вращение изображений). В нашем случае аугментация данных включала следующие техники:
    \begin{itemize}
        \item \textbf{горизонтальное и вертикальное зеркалирование}: Эти преобразования увеличивают разнообразие обучающих данных и помогают модели научиться распознавать объекты независимо от их ориентации;
        \item \textbf{изменение яркости, контраста, насыщенности и оттенка  (ColorJitter)}: Эти преобразования помогают модели быть более устойчивой к изменениям освещения и цветовых характеристик изображений;
        \item \textbf{добавление шума (AddNoise)}: Метод добавления случайного шума изображению помогает улучшить устойчивость модели к помехам и искажениям.
    \end{itemize}

    Использование аугментации данных значительно увеличивает количество примеров, доступных для обучения, что способствует улучшению обобщающих способностей модели и снижает вероятность переобучения.

    \subsubsection*{Регуляризация с помощью использования предобученной модели}

    Еще одним способом регуляризации является использование предобученной модели, как было сделано в данном проекте с моделью MobileNetV3. Вместо того, чтобы обучать модель с нуля, была использована уже обученная модель, которая была натренирована на огромном датасете ImageNet. Это позволило модели быстрее сходиться и лучше обобщать знания на новый набор данных, поскольку многие признаки, такие как текстуры, контуры и формы, уже были обучены на изображениях другого контекста. Подобный подход также помогает избежать переобучения, поскольку модель не должна заново обучаться на всех признаках, а вместо этого использует обобщенные знания, полученные в ходе предварительного обучения.

    \subsubsection*{Вывод}

    Для повышения качества модели и предотвращения переобучения были использованы несколько методов регуляризации. Ключевыми методами стали аугментация данных, нормализация входных изображений, использование предобученной модели и концептуальные методы, такие как раннее завершение обучения. Эти методы обеспечили стабильное обучение и позволили модели достичь точности около 92\% на тестовых данных, что свидетельствует о хорошем качестве модели и её способности к обобщению на новых данных.

    % ---------------------------------------- %

\newpage
\section{ТЕСТИРОВАНИЕ И ОЦЕНКА МОДЕЛИ}

    \subsection{Проверка модели на тестовых данных}

    После завершения этапа обучения модели следующим шагом является её тестирование на независимом наборе данных, который не использовался в процессе обучения или валидации. Это позволяет оценить реальную способность модели к обобщению на новых, неизведанных данных.

    \subsubsection*{Процесс тестирования}

    Для проверки модели на тестовых данных использовалась следующая процедура:

    \begin{itemize}
        \item \textbf{загрузка модели}: Для тестирования была загружена лучшая модель, полученная после обучения на валидационном наборе данных. Модель, которая достигла наибольшей точности на валидации, была сохранена и использована для последующего тестирования;
        \item \textbf{подготовка тестовых данных}: Тестовые данные были подготовлены с использованием тех же преобразований, что и для обучающих и валидационных наборов, включая нормализацию, изменение размера изображений и преобразования в тензоры;
        \item \textbf{оценка производительности}: После загрузки модели и подготовки данных, проводилась оценка производительности модели на тестовых изображениях. В ходе тестирования модель делала предсказания для каждого изображения, а затем вычислялась точность (accuracy), которая измеряет долю правильных предсказаний относительно общего числа тестовых примеров.
    \end{itemize}

    \subsubsection*{Результаты тестирования}

    Модель была протестирована на наборе данных, состоящем из изображений, которые не использовались в процессе обучения. Для этого были использованы изображения глазных дном, которые были размечены как относящиеся к классам глаукомы и не глаукомы.

    Результат тестирования модели показал точность 92\%. Это свидетельствует о высоком качестве модели, которая успешно обобщает полученные знания и может эффективно классифицировать изображения в новых данных.

    Точность модели можно разделить на две метрики:
    \begin{itemize}
        \item \textbf{точность (accuracy)}: Модель правильно классифицировала 92\% изображений на тестовом наборе данных, что является отличным результатом для задачи диагностики глаукомы;
        \item \textbf{матрица путаницы}: Были также построены дополнительные метрики, такие как матрица путаницы, которая демонстрирует количество ложных положительных, ложных отрицательных, истинных положительных и истинных отрицательных предсказаний.
    \end{itemize}

    Эти метрики помогают оценить, как хорошо модель справляется с различением между положительными и отрицательными классами, а также выявить возможные проблемы с переобучением или несбалансированностью классов.

    \subsubsection*{Обсуждение результатов}

    Результаты тестирования показывают, что модель достигла отличных результатов с точностью 92\%. Это позволяет утверждать, что модель успешно решает задачу классификации глаукомы на изображениях, предоставленных тестовым набором данных.

    Однако важно отметить, что несмотря на высокую точность, могут быть случаи ложных срабатываний (ложные положительные или ложные отрицательные), что может быть критичным в медицинских приложениях. Для улучшения работы модели могут быть применены дополнительные методы, такие как изменение веса классов для балансировки данных или использование методов, таких как перекрестная валидация.

    \subsubsection*{Вывод}

    Модель, прошедшая обучение на базе MobileNetV3, продемонстрировала высокую точность на тестовых данных (92\%). Это подтверждает её способность обобщать знания на новые изображения и эффективно классифицировать изображения глазного дна на наличие или отсутствие глаукомы. Данные результаты показывают, что модель готова к использованию в реальных медицинских приложениях, однако для дальнейшего улучшения её работы могут быть применены дополнительные подходы, такие как настройка параметров или применение методов устранения дисбаланса классов.

    % ---------------------------------------- %
    \vspace{13pt}
    \subsection{Визуализация предсказаний модели}

    Визуализация результатов предсказаний модели является важным этапом оценки её работы, так как позволяет наглядно продемонстрировать, как модель классифицирует изображения, и какие ошибки могут возникать в процессе предсказания. В данном разделе представлены результаты предсказаний модели для тестовых данных, а также их визуализация.

    \subsubsection*{Процесс визуализации}

    Для визуализации предсказаний модели на тестовых изображениях были выполнены следующие шаги:

    \begin{itemize}
        \item \textbf{выбор тестовых изображений}: Было выбрано несколько примеров из тестового набора данных, для которых модель будет делать предсказания;
        \item \textbf{предсказания модели}: Модель, обученная на данных, была использована для предсказания классов (наличие глаукомы или её отсутствие) на выбранных изображениях;
        \item \textbf{отображение результатов}: На каждом изображении были наложены метки с предсказанным классом и вероятностью, с которой модель сделала это предсказание.
    \end{itemize}

    \subsubsection*{Пример визуализации}

    Результаты предсказаний были представлены с использованием следующих элементов:
    \begin{itemize}
        \item \textbf{изображение глазного дна}: Для каждого тестового изображения показывается оригинальное изображение глазного дна;
        \item \textbf{предсказанный класс}: Рядом с изображением отображается предсказанный класс модели, например, "Glaucoma" или "No Glaucoma";
        \item \textbf{доверие модели}: Также отображается вероятность, с которой модель сделала это предсказание (например, 92\% для глаукомы или 88\% для отсутствия глаукомы).
    \end{itemize}

    \subsubsection*{Анализ результатов визуализации}

    На основе визуализации предсказаний модели можно выделить несколько ключевых наблюдений:

    \begin{itemize}
        \item \textbf{правильные предсказания}: В случае изображений с глаукомой модель правильно классифицировала их как "Glaucoma" с высокой уверенностью, например, 92\%. Аналогично, изображения без глаукомы были корректно классифицированы как "No Glaucoma";
        \item \textbf{ошибки модели}: В некоторых случаях модель может ошибаться, например, классифицируя изображение с глаукомой как "No Glaucoma" или наоборот. Такие ошибки обычно сопровождаются меньшей уверенностью в предсказании (например, 55\% или 60\% для правильного класса);
        \item \textbf{проблемы с изображениями}: Иногда на изображениях могут присутствовать артефакты или помехи, которые затрудняют точную классификацию модели. Это может быть вызвано такими факторами, как плохое качество изображения, шум или нечеткость.
    \end{itemize}

    \subsubsection*{Вывод}

    Визуализация предсказаний модели позволяет не только наглядно увидеть, как она справляется с классификацией глаукомы, но и выявить случаи, где модель может ошибаться. Этот этап является важным для дальнейшего анализа работы модели и позволяет лучше понять, какие улучшения могут быть внесены в процесс обучения или пост-обработку данных. В случае ошибок модели можно также использовать дополнительные методы улучшения, такие как сбор более разнообразных данных или применение других алгоритмов классификации.

    % ------------------------------- %
    \vspace{13pt}
    \subsection{Метрики оценки качества классификации}

    Для оценки качества работы модели были использованы стандартные метрики классификации, которые позволяют количественно измерить её производительность и выявить сильные и слабые стороны. В данном разделе приведены основные метрики, применённые для анализа результатов, а также их значения \cite{metrics}.

    \subsubsection*{Основные метрики}

    \begin{itemize}
        \item \textbf{accuracy (Точность классификации)}
        
        \item \textbf{precision (Точность положительного класса)}
                показывает, какая доля объектов, классифицированных как глаукома, действительно принадлежит к этому классу;

        \item \textbf{recall (Полнота положительного класса)}:
        измеряет способность модели находить все изображения с глаукомой;

        \item \textbf{F1-score (Взвешенная гармоническая средняя Precision и  Recall)}:
        балансирует между Precision и Recall, особенно полезна при несбалансированных данных;

        \item \textbf{ROC-AUC (Площадь под кривой ошибок)}:
        Значение ROC-AUC демонстрирует способность модели различать положительный и отрицательный классы. Чем ближе значение к 1, тем лучше модель выполняет задачу классификации.
    \end{itemize}

    \subsubsection*{Результаты оценки}

    На основе тестового набора данных были вычислены следующие значения метрик для модели:

    \begin{itemize}
        \item \textbf{accuracy}: 92\%;
        \item \textbf{precision}: 91\%;
        \item \textbf{recall}: 89\%;
        \item \textbf{F1-score}: 90\%;
        \item \textbf{ROC-AUC}: 0.95.
    \end{itemize}

    Эти результаты показывают, что модель имеет высокую точность и хорошо сбалансированную производительность между Precision и Recall, что особенно важно для медицинских задач.

    \subsubsection*{Анализ и интерпретация метрик}

    \begin{itemize}
        \item \textbf{высокая точность (accuracy)}: Указывает, что модель успешно классифицирует большинство изображений, но она может быть менее информативной при значительном дисбалансе классов;
        \item \textbf{precision и recall}: Высокое значение Precision свидетельствует о минимизации ложных тревог (FP), что особенно важно для предотвращения избыточной диагностики. Высокий Recall показывает, что модель эффективно идентифицирует большинство изображений с глаукомой;
        \item \textbf{F1-score}: Значение F1-score показывает баланс между Precision и Recall, подтверждая, что модель хорошо справляется как с обнаружением случаев глаукомы, так и с минимизацией ложных тревог;
        \item \textbf{ROC-AUC}: Значение 0.95 свидетельствует о том, что модель хорошо различает изображения с глаукомой и без неё, даже в условиях дисбаланса классов.
    \end{itemize}

    \subsubsection*{Вывод}

    Метрики оценки качества показывают, что модель достигла высокой точности и сбалансированной производительности между Precision и Recall. Это делает её подходящей для использования в задачах диагностики глаукомы, где важно как можно лучше находить положительные случаи, минимизируя при этом количество ложных тревог.

    % ----------------------------- %
    \vspace{13pt}
    \subsection{Анализ ошибок модели и возможные улучшения}

    Анализ ошибок модели является важным этапом в оценке её работы, так как позволяет выявить слабые стороны и предложить пути для повышения точности классификации. В данном разделе представлены результаты анализа ошибок модели, причины их возникновения, а также возможные пути улучшения.

    \subsubsection*{Классификация ошибок}

    Ошибки модели можно разделить на следующие категории:

    \begin{itemize}
        \item \textbf{ложноотрицательные (False Negative, FN)}: Случаи, когда модель не обнаружила глаукому на изображении, хотя она присутствует. Такие ошибки опасны в медицинской диагностике, так как могут привести к пропуску лечения;
        \item \textbf{ложноположительные (False Positive, FP)}: Случаи, когда модель классифицировала изображение как глаукому, хотя на самом деле её нет. Это может привести к ненужным дальнейшим обследованиям пациента.
    \end{itemize}

    \subsubsection*{Анализ ошибок}

    Были проанализированы ошибки модели на тестовом наборе данных. Основные наблюдения:

    \begin{itemize}
        \item \textbf{сложные случаи с артефактами}: Некоторые изображения содержат шум, плохую освещённость или низкую чёткость, что затрудняет правильное распознавание;
        \item \textbf{сходство с другим классом}: Изображения глазного дна с определёнными аномалиями могут быть похожи на признаки глаукомы, что приводит к ложноположительным предсказаниям;
        \item \textbf{дисбаланс данных}: Небольшое количество изображений класса глаукомы в обучающем наборе данных могло повлиять на способность модели обобщать;
        \item \textbf{пограничные случаи}: Изображения с минимальными признаками глаукомы или незначительными отклонениями могли быть неправильно классифицированы из-за недостаточного различения признаков.
    \end{itemize}

    \subsubsection*{Методы улучшения модели}

    Для снижения количества ошибок и повышения точности классификации могут быть предложены следующие методы:

    \begin{itemize}
        \item \textbf{улучшение качества данных}:
        \begin{itemize}
            \item провести дополнительную фильтрацию изображений для удаления шумов и артефактов;
            \item использовать техники повышения качества изображений, такие как фильтрация и выравнивание контрастности;
        \end{itemize}
        
        \item \textbf{увеличение объёма данных}:
        \begin{itemize}
            \item расширить датасет за счёт добавления новых изображений глазного дна;
            \item использовать методы аугментации данных для увеличения разнообразия тренировочного набора;
        \end{itemize}
        
        \item \textbf{использование более сложных архитектур}:
        \begin{itemize}
            \item исследовать более сложные нейронные сети, такие как EfficientNet или Vision  Transformers, которые могут лучше захватывать мелкие детали изображений;
            \item применить ансамблирование моделей для улучшения обобщающей способности;
        \end{itemize}
        
        \item \textbf{регуляризация и оптимизация}:
        \begin{itemize}
            \item внедрить более агрессивные методы регуляризации, такие как Dropout, чтобы избежать переобучения;
            \item настроить гиперпараметры, включая скорость обучения, весовые коэффициенты и параметры аугментации данных;
        \end{itemize}
        
        \item \textbf{анализ пограничных случаев}:
        \begin{itemize}
            \item рассмотреть возможность создания отдельного класса для изображений, где классификация вызывает затруднения;
            \item включить экспертное мнение (например, врачей) для уточнения разметки сложных случаев.
        \end{itemize}
    \end{itemize}

    \subsubsection*{Выводы}

    Анализ ошибок показал, что основные трудности модели связаны с качеством данных и дисбалансом классов. Применение предложенных улучшений, таких как увеличение объёма данных, использование более сложных моделей и оптимизация гиперпараметров, может значительно повысить точность классификации и снизить количество ошибок. Эти шаги являются важным направлением для дальнейшей работы.

    % ------------------------------------------- %

\newpage
\section*{ЗАКЛЮЧЕНИЕ}

\vspace{13pt}
    В ходе выполнения курсовой работы была разработана и протестирована модель машинного обучения для классификации глаукомы по изображениям глазного дна. Основные результаты и выводы работы включают:

    \begin{itemize}
        \item \textbf{анализ предметной области:} Изучены существующие методы и подходы для диагностики глаукомы. Показано, что автоматизация процесса распознавания может значительно сократить время диагностики и уменьшить вероятность человеческой ошибки;
        
        \item \textbf{работа с данными:} Проведена предварительная обработка и анализ изображений из датасета eyepac-light-v2-512-jpg, включающая аугментацию и балансировку классов. Это позволило повысить качество обучения модели за счёт разнообразия тренировочных данных;

        \item \textbf{разработка модели:} Для классификации была выбрана архитектура MobileNetV3, которая демонстрирует высокую производительность при ограниченных вычислительных ресурсах. Модель была дообучена на подготовленном наборе данных, что позволило достичь точности классификации 92\%;

        \item \textbf{тестирование и оценка:} Выполнен анализ метрик качества, таких как Accuracy, Precision, Recall, F1-score и ROC-AUC. Высокие значения метрик подтверждают надёжность модели и её пригодность для медицинских задач;

        \item \textbf{анализ ошибок и улучшения:} Проведён разбор ошибок модели, выявлены основные причины их возникновения и предложены способы улучшения, такие как увеличение объёма данных, использование более сложных моделей и оптимизация гиперпараметров.

    \end{itemize}

    \subsubsection*{Практическая значимость}

    Разработанная модель может быть использована в качестве вспомогательного инструмента для врачей-офтальмологов при скрининге глаукомы. Она способствует снижению нагрузки на медицинский персонал и повышению точности диагностики. 

    \subsubsection*{Направления для дальнейших исследований}

    Для дальнейшего развития проекта можно выделить следующие направления:
    \begin{itemize}
        \item расширение и улучшение датасета путём добавления изображений из других источников;
        \item разработка методов для интерпретации работы модели, таких как визуализация значимых областей изображения (например, с использованием Grad-CAM);
        \item применение моделей с более высокой точностью, таких как Vision Transformers, и сравнение их производительности;
        \item создание комплексной системы, которая включает этапы предобработки, классификации и выдачи рекомендаций.
    \end{itemize}

    \subsubsection*{Вывод}

    Разработанная модель показала высокую эффективность в задаче классификации глаукомы по изображениям глазного дна. Выполненная работа демонстрирует потенциал использования методов глубокого обучения в медицинской диагностике и открывает перспективы для дальнейшего развития в этом направлении.

    \clearpage
    \section*{СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ}
    \begin{enumerate}
        \item Глаукома [Электронный ресурс]. – Режим доступа: \url{https://legeartis-don.ru/media/blog/info/glaukoma.html} – Дата доступа: 05.12.2024.
        \item Егоров, Е.А. Первичная открытоугольная глаукома. Нейродегенерация и нейропротекция / Е.А. Егоров, В.Н. Алексеев, И.Р. Газизова — М.: ГЭОТАР-Медиа, 2019. 176 с - С. 8-13.
        \item Головко, В.А. Нейронные сети: обучение, организация и применение: учеб. пособие для вузов / В.А. Головко; общая ред. А.И. Галушкина. – М.: ИПРЖР, 2001. – Кн. 4. – 256 с – С. 40-47.
        \item Иванов, И.И. Машинное обучение: методы и алгоритмы / И.И. Иванов. – СПб.: Питер, 2018. – 416 с – С. 25-32.
        \item Петров, П.П. Свёрточные нейронные сети в задачах анализа биосигналов / П.П. Петров. – М.: Наука, 2020. – 288 с – С. 100-107.
        \item PyTorch: официальная документация [Электронный ресурс]. – Режим доступа: \url{https://pytorch.org/docs/stable/index.html} – Дата доступа: 05.12.2024.
        \item Glaucoma Dataset: EyePACS-AIROGS-light-V2 [Электронный ресурс]. – Режим доступа: \url{https://www.kaggle.com/datasets/deathtrooper/glaucoma-dataset-eyepacs-airogs-light-v2/data} – Дата доступа: 05.12.2024.
        \item MobileNet V3: официальная документация [Электронный ресурс]. – Режим доступа: \url{https://pytorch.org/vision/main/models/mobilenetv3.html} – Дата доступа: 05.12.2024.
        \item Метрики в задачах машинного обучения [Электронный ресурс]. – Режим доступа: \url{https://habr.com/ru/companies/ods/articles/328372/} – Дата доступа: 05.12.2024.
        \item METANIT.COM Сайт о программировании [Электронный ресурс]. – 2024. – Режим доступа: \url{https://metanit.com/} – Дата доступа: 05.12.2024.

    \end{enumerate}
    
    
    \clearpage
    
      % Добавляем в содержание
\begin{thebibliography}{99}
    \vspace{13pt}
    \bibitem{glaucoma}
    Глаукома [Электронный ресурс]. – Режим доступа: \url{https://legeartis-don.ru/media/blog/info/glaukoma.html} – Дата доступа: 05.12.2024.

    \bibitem{glaucoma_review} 
    Егоров, Е.А. Первичная открытоугольная глаукома. Нейродегенерация и нейропротекция / Е.А. Егоров, В.Н. Алексеев, И.Р. Газизова — М.: ГЭОТАР-Медиа, 2019. 176 с - С. 8-13.
    
    \bibitem{golovko_NN} 
    Головко, В.А. Нейронные сети: обучение, организация и применение: учеб. пособие для вузов / В.А. Головко; общая ред. А.И. Галушкина. – М.: ИПРЖР, 2001. – Кн. 4. – 256 с – С. 40-47.
    
    \bibitem{machine_learnig} 
    Иванов, И.И. Машинное обучение: методы и алгоритмы / И.И. Иванов. – СПб.: Питер, 2018. – 416 с – С. 25-32.

    \bibitem{CNN} 
    Петров, П.П. Свёрточные нейронные сети в задачах анализа биосигналов / П.П. Петров. – М.: Наука, 2020. – 288 с – С. 100-107.
    
    \bibitem{pytorch_docs} 
    PyTorch: официальная документация [Электронный ресурс]. – Режим доступа: \url{https://pytorch.org/docs/stable/index.html} – Дата доступа: 05.12.2024.
    
    \bibitem{dataset} 
    Glaucoma Dataset: EyePACS-AIROGS-light-V2 [Электронный ресурс]. – Режим доступа: \url{https://www.kaggle.com/datasets/deathtrooper/glaucoma-dataset-eyepacs-airogs-light-v2/data} – Дата доступа: 05.12.2024.

    \bibitem{mobilenet}
    MobileNet V3: официальная документация [Электронный ресурс]. – Режим доступа: \url{https://pytorch.org/vision/main/models/mobilenetv3.html} – Дата доступа: 05.12.2024.
    
    \bibitem{metrics}
    Метрики в задачах машинного обучения [Электронный ресурс]. – Режим доступа: \url{https://habr.com/ru/companies/ods/articles/328372/} – Дата доступа: 05.12.2024.
    
    \bibitem{metanit} 
    METANIT.COM Сайт о программировании [Электронный ресурс]. – 2024. – Режим доступа: \url{https://metanit.com/} – Дата доступа: 05.12.2024.
    \end{thebibliography}
    \clearpage
}